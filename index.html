<!DOCTYPE html>
<html>
<head>
    <title>Google Docs</title>
    <link rel="shortcut icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon-2023q4.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        html, body {
            font-family: sans-serif;
            margin: 0;
            --border-width: 2.5px;
        }
        h1 {
            text-align: center;
        }
        #frame, #staticFrame, #contentFallback {
            border: none;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100vh;
        }
        .flat-button {
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;

            text-align: center;
            background-color: transparent;
            color: white;
            padding: -2px;
            border-radius: 100%;
            border-color: white;
            border-style: solid;
            border-width: var(--border-width);
            cursor: pointer;
            font-size: 100%;
            height: 100%;
            aspect-ratio: 1;
            transition-duration: 1s;
        }
        .Navbar {
            display: flex;
            gap: 10px;
            align-items: center;
            width: calc(100%-10px);
            height: 40px;
            padding: 5px;
            background-color: hsl(230, 40%, 18%);
            border-width: 0;
            border-bottom-width: var(--border-width);
            border-color: white;
            border-style: solid;
            z-index: 9999;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 250ms ease-in-out;
        }
        .flat-button #input {
            align-content: center;
            align-self: center;
            pointer-events: all;
            box-sizing: border-box;
        }
        #input {
            height: 100%;
            width: 100%;
            background-color: hsl(230, 40%, 48%);
            border-style: solid;
            border-color: white;
            color: white;
            border-width: var(--border-width);
            font-size: 100%;
        }
        #refresh {
            rotate: 0deg;
            transition: rotate 700ms ease-out;
        }
        #tabs {
            --scrollbar-size: 4px;
            height: 100%;
            color: white;
            display: flex;
            white-space: nowrap;
            overflow: auto;
            gap: 10px;
        }
        #tabs::-webkit-scrollbar {
            background-color: transparent;
            height: var(--scrollbar-size);
        }
        #tabs::-webkit-scrollbar-thumb {
            background: white;
            padding: 0.5px;
            border-radius: var(--scrollbar-size);
        }
        /* Overlay shown when we can't preserve cross-origin iframe content */
        #frozenOverlay {
            position: absolute;
            inset: 40px 0 0 0; /* below navbar */
            display: none;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.6);
            color: white;
            z-index: 9998;
            font-size: 1.1rem;
        }
    </style>
</head>
<script>
const ParentWindow = true
document.addEventListener('click', function() {
    let w = open("")

    w.document.head.innerHTML += document.head.innerHTML
    w.document.body.innerHTML += document.getElementById("Content").innerHTML

    const definitions = w.document.createElement("script")
    definitions.textContent = document.getElementById("definitions").innerHTML
    w.document.head.appendChild(definitions)
    w.focus()
    close()
});
</script>
<script id="definitions" type="text/javascript">
if (window.opener) {

let frame;
let staticFrame;
let contentFallback;
let refresh;
let input;
let isStaticContent = false;
let staticSrc = "";

let unloadCallback = false;

if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", init);
} else {
    init();
}

function init() {
    frame = document.getElementById("frame");
    staticFrame = document.getElementById("staticFrame");
    contentFallback = document.getElementById("contentFallback")
    refresh = document.getElementById("refresh");
    input = document.getElementById("input");

    frame.contentWindow.addEventListener("unload", function(){
        if (unloadCallback) {
            console.log("unload");
            showStopLoad()
        } else {
            unloadCallback = true;
        }
    });
    staticFrame.contentWindow.addEventListener("unload", function(){
        if (unloadCallback) {
            showDynamicContent()
            frame.src = staticFrame.src
            console.log("unload static");
        }
    });
}

function showRefresh() {
    refresh.hidden = false;
    stopLoad.hidden = true;
}

function showStopLoad() {
    refresh.hidden = true;
    stopLoad.hidden = false;
}

function showDynamicContent() {
    staticFrame.hidden = true;
    frame.hidden = false;
    contentFallback.hidden = true;
    isStaticContent = false;
}

function showStaticContent() {
    staticFrame.hidden = false;
    frame.hidden = true;
    contentFallback.hidden = true;
    isStaticContent = true;
}

function showFallbackContent() {
    staticFrame.hidden = true;
    frame.hidden = true;
    contentFallback.hidden = false;
    isStaticContent = true;
}

function isValidUrl(url) {
  try {
    new URL(url);
    return true;
  } catch (error) {
    return false;
  }
}

function LoadContent() {
    showDynamicContent()
    // remove previous listener on the iframe element if present
    if (typeof loadEventListener !== "undefined" && loadEventListener) {
        frame.removeEventListener("load", ContentLoaded);
    }
    frame.addEventListener("load", ContentLoaded);

    frame.src = input.value;
    showStopLoad();
}

function StopLoadContent() {
    // Primary attempt: instruct the iframe's window to stop loading.
    try {
        if (frame && frame.contentWindow) {
            frame.contentWindow.stop();
            showRefresh();
            return;
        }
    } catch (e) {
        // Cross-origin access may throw when trying to call stop()
        console.warn('frame.contentWindow.stop() threw:', e);
    }

    // Fallback for same-origin: capture current DOM into the staticFrame using srcdoc
    try {
        // Accessing document will throw for cross-origin
        staticSrc = frame.src;
        const docHtml = frame.contentWindow.document.documentElement.outerHTML;
        staticFrame.srcdoc = docHtml;
        showStaticContent();
        frame.src = 'about:blank';
        showRefresh();
        return;
    } catch (e) {
        console.warn('Same-origin snapshot failed (probably cross-origin):', e);
    }

    // Last-resort visual fallback: show a frozen overlay
    try {
        frame.src = 'about:blank';
        showFallbackContent()
        showRefresh();
    } catch (e) {
        console.warn('Cross-origin fallback failed:', e);
    }
}

function RefreshContent() {
    console.log("refresh")
    if (isStaticContent) {
        frame.src = staticSrc
    } else {
        input.value = frame.src;
    }
    LoadContent()
}

function ContentLoaded() {
    console.log("Loaded");
    
    if (!isStaticContent) {
        input.value = frame.src;
    }
    
    showRefresh();
    const rotation = Number(refresh.style.rotate.replace("deg","") || 0);
    refresh.style.rotate = `${360 + rotation}deg`;

    try {
        frame.contentWindow.focus();
    } catch (e) {}
}

function UrlInputKeyDown(Key) {
    if (Key.code === "Enter") {
        //Validate URL
        if ((!isValidUrl(input.value)) && (input.value.indexOf(".") != -1)) {
            input.value = "http://"+input.value;
        }
        if (input.value.indexOf(".") == 0 || input.value.length==0) {
            input.value = "https://standofevil1555.sevalla.page/";
        }
        LoadContent();
    }
}

}
</script>
<body>
    <div id="Content" hidden="true">
        <div class="Navbar">
            <button class="flat-button" id="refresh" onclick="RefreshContent()">&#x21bb;</button>
            <button class="flat-button" id="stopLoad" onclick="StopLoadContent()" hidden="true">x</button>
            <Input type="url" id="input" onkeydown="UrlInputKeyDown(event)" value="https://standofevil1555.sevalla.page/">
            <!--<div id="tabs">
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 1eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</div>
                <div>tab 2</div>
                <div>tab 2</div>
                <div>tab 2</div>
            </div>-->
        </div>
        <iframe src="https://standofevil1555.sevalla.page/" id="frame"></iframe>
        <iframe id="staticFrame" hidden="true"></iframe>
        <div id="contentFallback" hidden="true">
            <h1>
                Access denied to embedded page content
                <br>
                :(
            </h1>
        </div>
    </div>
    <h1>
        Hello! Click anywhere to continue
        <br>
        u1
    </h1>
</body>
</html>